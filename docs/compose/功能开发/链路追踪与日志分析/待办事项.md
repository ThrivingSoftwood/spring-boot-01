### 1. 建立“边界桥梁” (跨服务透传)

* **目标：** 确保 TraceID 不会在 HTTP 调用时断掉。
* **要做什么：**
    * 在 `common-web` 中，为 `RestClient`（或 `RestTemplate`）提供一个**自动配置类(`RestClientConfig`已创建待验证)**。
    * 利用 Spring Boot 4 的自动探测机制，确保外调工具会自动在 Header 中注入 `traceparent`。
* **关键代码意图：** `builder.observationRegistry(registry).build()`。

### 2. 部署“安全守卫” (网关防御)

* **目标：** 防止外部恶意注入 TraceID。
* **要做什么：**
    * 在网关层（Gateway）编写一个过滤器。
    * **逻辑：** 检查外部请求头。如果是来自公网的请求，**强制清除**其自带的 Trace 信息并重新生成，只信任内网服务间的透传。

### 3. 启用“业务行李” (Baggage 机制)

* **目标：** 进行 Baggage 透传,让链路不仅有 ID，还能自带业务上下文（如：租户ID、用户角色）。
* **要做什么：**
    * 在 `application.yml` 的 `management.tracing.baggage` 中声明允许透传的字段。
    * 在代码中使用 `Tracer.createBaggage("tenant-id")` 设置值。
* **效果：** 一次设置，全链路（所有微服务）的日志里都会自动出现这个字段。

### 4. 生产环境“数据治理” (采样与脱敏)

* **目标：** 保护隐私并降低性能开销。
* **要做什么：**
    * **配置采样：** 在生产环境下将 `sampling.probability` 从 `1.0` 降至 `0.1`（甚至更低）。
    * **数据脱敏：** 在 `otel-collector-config` 中增加 `redaction` 或 `attributes` 处理器，自动过滤掉日志/链路中包含
      `password` 或 `token` 的字段。

### 5. 其他

1. 配置 Elasticsearch 索引生命周期管理 (ILM) 策略，设定 Hot/Warm 阶段以自动清理陈旧日志，防止磁盘空间溢出。
2. 在 Kibana 中构建可观测性仪表盘（Dashboard），集成 Tracing 聚合图表与 Logs 实时流分析视图。
3. 持续跟进 Prometheus 指标采集模块与 Spring Boot Actuator 的深度集成，补全“指标（Metrics）”维度的观测能力。