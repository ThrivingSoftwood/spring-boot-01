<?xml version="1.0" encoding="UTF-8"?>
<project xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://maven.apache.org/POM/4.0.0"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <parent>
        <groupId>thriving.softwood</groupId>
        <artifactId>common</artifactId>
        <version>0.0.2-SNAPSHOT</version>
    </parent>
    <groupId>thriving.softwood.common</groupId>
    <artifactId>common-observability</artifactId>
    <name>common-observability</name>
    <description>å¯è§‚æµ‹æ€§åº•åº§ï¼šé›†æˆæ—¥å¿—å¢å¼ºã€é“¾è·¯è¿½è¸ªï¼ˆTracingï¼‰ä¸æŒ‡æ ‡ç›‘æ§ï¼ˆMetricsï¼‰</description>

    <properties>
        <java.version>${jdk.version}</java.version>
    </properties>

    <dependencies>
        <!-- ======================================================== -->
        <!-- 01. å†…éƒ¨æ ¸å¿ƒä¾èµ–                                          -->
        <!-- ======================================================== -->
        <dependency>
            <groupId>thriving.softwood.common</groupId>
            <artifactId>common-core</artifactId>
            <!-- ä¾èµ–é¡¹ç›®åŸºç¡€å·¥å…·ç±»ã€å¸¸é‡å®šä¹‰åŠæšä¸¾ -->
        </dependency>

        <!-- ======================================================== -->
        <!-- 02. åŸºç¡€æ—¥å¿—ä½“ç³» (Logging Facade & Performance)          -->
        <!-- ======================================================== -->
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
            <version>${slf4j.version}</version>
            <!-- SLF4J æ—¥å¿—é—¨é¢ï¼Œè§£è€¦åº•å±‚æ—¥å¿—å®ç° -->
        </dependency>
        <dependency>
            <groupId>com.lmax</groupId>
            <artifactId>disruptor</artifactId>
            <!-- æ— é”å¹¶å‘é˜Ÿåˆ—ï¼Œç”¨äº Log4j2 çš„å…¨å¼‚æ­¥é«˜æ€§èƒ½æ—¥å¿—å¤„ç† -->
        </dependency>
        <!-- ğŸš€ å¼•å…¥ Log4j2 Starter (æä¾› log4j-core å’Œ log4j-api) ,è¿™è§£å†³äº† AbstractAppender æ‰¾ä¸åˆ°çš„é—®é¢˜ -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-log4j2</artifactId>
        </dependency>

        <!-- ======================================================== -->
        <!-- 03. Spring Boot è§‚æµ‹æ€§æ ¸å¿ƒ (Actuator & Observation)      -->
        <!-- ======================================================== -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-actuator</artifactId>
            <exclusions>
                <exclusion>
                    <groupId>org.springframework.boot</groupId>
                    <artifactId>spring-boot-starter-logging</artifactId>
                    <!-- æ ¸å¿ƒæ“ä½œï¼šæ’é™¤é»˜è®¤çš„ Logback å®ç°ï¼Œé˜²æ­¢ä¸ Log4j2 å†²çª -->
                </exclusion>
            </exclusions>
            <!-- Spring ç”Ÿæ€è§‚æµ‹æ€§æ¢çº½ï¼šç®¡ç† ObservationRegistry ä¸åŸºç¡€ Metrics -->
        </dependency>

        <!-- ======================================================== -->
        <!-- 04. Micrometer Tracing æŠ½è±¡å±‚ (Sleuth çš„ç»§ä»»è€…)            -->
        <!-- ======================================================== -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-micrometer-tracing</artifactId>
            <!-- Spring Boot 4 å¯¹ Micrometer Tracing çš„è‡ªåŠ¨é…ç½®æ”¯æŒ -->
        </dependency>
        <dependency>
            <groupId>io.micrometer</groupId>
            <artifactId>micrometer-tracing</artifactId>
            <!-- Micrometer é“¾è·¯è¿½è¸ªæ ¸å¿ƒ API æŠ½è±¡ -->
        </dependency>

        <!-- ======================================================== -->
        <!-- 05. OpenTelemetry å®ç°ä¸æ¡¥æ¥ (Tracing Implementation)     -->
        <!-- ======================================================== -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-micrometer-tracing-opentelemetry</artifactId>
            <!-- Spring Boot å®˜æ–¹æä¾›çš„ OpenTelemetry è‡ªåŠ¨è£…é…é€‚é…å™¨ -->
        </dependency>
        <dependency>
            <groupId>io.micrometer</groupId>
            <artifactId>micrometer-tracing-bridge-otel</artifactId>
            <!-- å…³é”®æ¡¥æ¥åŒ…ï¼šå°† Micrometer Tracing API æ˜ å°„è‡³ OpenTelemetry SDK -->
        </dependency>

        <!-- ======================================================== -->
        <!-- 06. é“¾è·¯æ•°æ®å¯¼å‡ºå™¨ (Exporters - æ•°æ®å¤–æµç®¡é“)               -->
        <!-- ======================================================== -->
        <dependency>
            <groupId>io.opentelemetry</groupId>
            <artifactId>opentelemetry-exporter-otlp</artifactId>
            <scope>runtime</scope>
            <!-- å·¥ä¸šæ ‡å‡† OTLP åè®®å¯¼å‡ºå™¨ï¼šç”¨äºå°† Trace æ•°æ®å‘é€è‡³ OTel Collector -->
        </dependency>
        <dependency>
            <groupId>io.opentelemetry</groupId>
            <artifactId>opentelemetry-exporter-zipkin</artifactId>
            <scope>runtime</scope>
            <!-- Zipkin ä¸“ç”¨å¯¼å‡ºå™¨ï¼šç”¨äºç›´æ¥å°† Span æ•°æ®æ¨é€è‡³ Zipkin æŒä¹…åŒ–åç«¯ -->
        </dependency>
        <!-- OpenTelemetry Log4j2 Appender è¿™ä¸ªåº“å…è®¸ Log4j2 ç›´æ¥å°†æ—¥å¿—è½¬æ¢æˆ OTLP æ ¼å¼å‘é€ -->
        <dependency>
            <groupId>io.opentelemetry.instrumentation</groupId>
            <artifactId>opentelemetry-log4j-appender-2.17</artifactId>
            <version>${otel.log4j.appender.version}</version>
        </dependency>
        <!--OTEL SDK,ç”¨äºæ‰˜ç®¡ OpenTelemetry å¯¹è±¡åˆ° Spring-->
        <dependency>
            <groupId>io.opentelemetry</groupId>
            <artifactId>opentelemetry-api</artifactId>
        </dependency>
        <!-- ğŸš€ æ–°å¢ï¼šOpenTelemetry SDK (ç”¨äºç¼–å†™è‡ªå®šä¹‰ Processor) -->
        <dependency>
            <groupId>io.opentelemetry</groupId>
            <artifactId>opentelemetry-sdk</artifactId>
        </dependency>
    </dependencies>

    <build>
        <resources>
            <resource>
                <directory>src/main/resources</directory>
            </resource>
        </resources>
    </build>
</project>